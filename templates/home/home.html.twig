{#<!-- templates/home/home.html.twig -->#}
{% extends 'base.html.twig' %}

{% block head %}
    <script type="text/javascript">
        function actualizarProductosPorCategoria(categoriaNombre) {
            // Construir la URL para la solicitud AJAX
            let url = "{{ path('productos_por_categoria', {'categoria': categoriaNombre}) }}";

            // Realizar la solicitud AJAX
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    // Aquí puedes actualizar el DOM con los productos de la categoría seleccionada
                    const productsContainer = document.getElementById('content-' + categoriaNombre);
                    productsContainer.innerHTML = ''; // Limpiar los productos existentes

                    // Agregar los nuevos productos al DOM
                    data.forEach(producto => {
                        const productCard = document.createElement('div');
                        productCard.className = 'product-card';
                        productCard.innerHTML = `
                            <img src="{{ asset('IMAGEN') }}" alt="${producto.nombre}">
                            <h3>${producto.nombre}</h3>
                            <p class="price">
                                <span class="current-price">${producto.precio}€</span>
                            </p>
                            <button class="add-to-cart">Añadir al carrito</button>
                        `.replace('IMAGEN', producto.imagen);
                        productsContainer.appendChild(productCard);
                    });
                })
                .catch(error => console.error('Error:', error));
        }
    </script>
{% endblock %}
{% block body %}
    <div class="container">
        <ul class="nav nav-tabs" id="categoryTab" role="tablist">
            {% for categoria in categorias %}
                <li class="nav-item" role="presentation">
                    <button class="nav-link {% if loop.first %}active{% endif %}" id="tab-{{ categoria.categoria }}" data-bs-toggle="tab" data-bs-target="#content-{{ categoria.categoria }}" type="button" role="tab" aria-controls="content-{{ categoria.categoria }}" aria-selected="{% if loop.first %}true{% else %}false{% endif %}" onclick="actualizarProductosPorCategoria('{{ categoria.categoria }}')">{{ categoria.categoria }}</button>
                </li>
            {% endfor %}
        </ul>
        <div class="tab-content" id="categoryTabContent">
            {% for categoria in categorias %}
                <div class="tab-pane fade {% if loop.first %}show active{% endif %}" id="content-{{ categoria.categoria }}" role="tabpanel" aria-labelledby="tab-{{ categoria.categoria }}">
                    <div id="products" class="product-list">
                        {% for producto in productos %}
                            <div class="product-card">
                                <img src="{{ asset(producto.imagen) }}" alt="{{ producto.nombre }}">
                                <h3>{{ producto.nombre }}</h3>
                                <p class="price">
                                    <span class="current-price">{{ producto.precio }}€</span>
                                </p>
                                <button class="add-to-cart">Añadir al carrito</button>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>

{% endblock %}

{% block javascripts %}
    {{ encore_entry_script_tags('app') }}
{% endblock %}

{% block footer %}
    <footer>
        <ul>
            <li><a href="#">Quiénes somos</a></li>
            <li><a href="#">Preguntas frecuentes</a></li>
            <li><a href="#">Medios de pago aceptados</a></li>
        </ul>
    </footer>
{% endblock %}
